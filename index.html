<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>ml-esri-maps-ng by daveegrant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">ml-esri-maps-ng</h1>
      <h2 class="project-tagline">AngularJS directives with Esri Maps integration for use with MarkLogic REST-api.</h2>
      <a href="https://github.com/daveegrant/ml-esri-maps-ng" class="btn">View on GitHub</a>
      <a href="https://github.com/daveegrant/ml-esri-maps-ng/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/daveegrant/ml-esri-maps-ng/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
        <a id="welcome-to-github-pages" class="anchor" href="#title" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Overview
      </h2>

      <img src="img/map.png">

      <h4>Key Features:</h4>
      <ul>
        <li>Show multiple geospatial facets on one map</li>
        <li>Fast display of cluster markers</li>
        <li>Distinctly colored markers per facet</li>
        <li>Mouse interaction:</li>
        <ul>
          <li>Double-click to zoom in and limit geo search</li>
          <li>Drag to change center and limit geo search</li>
          <li>Click on single point markers to show details</li>
        </ul>
      </ul>

      <h2>
        <a id="quickstart" class="anchor" href="#title" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quickstart
      </h2>

      <p>To start using Esri Maps for MarkLogic, follow these steps to get started.</p>

      <ol type="1">
        <li>
          <p>Download <a href="https://github.com/daveegrant/ml-esri-maps-ng/blob/master/dist/ml-esri-maps-ng.js">ml-esri-maps-ng</a> (<a href="https://github.com/daveegrant/ml-esri-maps-ng/blob/master/dist/ml-esri-maps-ng.min.js">minified version</a>) and put it with your other scripts.  Alternatively, you can use Bower to install it automatically:</p>

          <div>
            <pre><code>bower install [--save] ml-esri-maps-ng</code></pre>
          </div>

          <p></p>
        </li>
        <li>
          <p>Load ml-esri-maps-ng.js into your HTML page (typically in the end of the BODY of your HTML):</p>

          <div>
            <pre><code>&lt;script src='/bower_components/ml-google-esri-ng/dist/ml-esri-maps-ng[.min].js'&gt;&lt;/script&gt;</code></pre>
          </div>

          <p></p>
        </li>
        <li>
          <p>Include the Esri Javascript API:</p>

          <div>
            <pre><code>&lt;script src='//js.arcgis.com/3.14/'&gt;&lt;/script&gt;</code></pre>
          </div>

          <p></p>
        </li>
        <li>
          <p>Load Esri stylesheet and the ml-esri-maps-ng.css into your HTML page (typically in the end of the HEAD of your HTML):</p>

          <div>
            <pre><code>&lt;link rel="stylesheet" href="//js.arcgis.com/3.14/esri/css/esri.css"&gt;
&lt;link rel="stylesheet" href="/bower_components/ml-esri-maps-ng/dist/ml-esri-maps-ng.css"&gt;</code></pre>
          </div>

          <p></p>
        </li>
        <li>
          <p>Update your application module to depend on the <code>ml-esri-maps-ng</code> module:</p>

          <div>
            <pre><code>angular.module('myApplicationModule', ['ml.esri-maps']);</code></pre>
          </div>

          <p></p>
        </li>
      </ol>

      <h2>
        <a id="welcome-to-github-pages" class="anchor" href="#title" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Directives
      </h2>

      <ul>
        <li><a href="#ml-esri-search-map">ml-esri-search-map</a></li>
        <li><a href="#ml-esri-detail-map">ml-esri-detail-map</a></li>
      </ul>

      <h2>
        <a id="ml-esri-search-map" class="anchor" href="#ml-esri-search-map" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ml-esri-search-map
      </h2>

      <h4>Description:</h4>

      <p>The <code>ml-esri-search-map</code> directive utilizes geospatial facet data to draw cluster markers on  the map.  The geospatial facet data is expected to have a box coordinates along with the count for the number of items contained in the box.  When the facets data has multiple geospatial facets, each facet gets a unique color for the cluster markers (up to 5 different colors).</p>

      <h4>Attributes:</h4>

      <ul>
        <li>
          <code>options</code>: The options used to initialize the map.  Possible properties of the object are:
          <ul>
            <li><code>center</code>: The latitude and longitude for the center of the map (e.g - [52.00, 4.84]).</li>
            <li><code>zoom</code>: The zoom level of the map.</li>
            <li><code>baseMap</code>: The Esri base map to use (<a href="https://developers.arcgis.com/javascript/jsapi/esri.basemaps-amd.html">Esri base map options</a>).</li>
          </ul>
        </li>
        <li>
          <code>facets</code>: The JSON object containing the facets to be used to create data on the map.
        </li>
        <li>
          <code>bounds-changed</code>: The callback function reference when the bounds of the map are changed.  
        </li>
      </ul>

      <h4>Example:</h4>

      <p>To use the <code>ml-esri-search-map</code> directive, you must first follow the steps in the <a href="#quickstart">Quickstart</a> section to prepare your application.  Then follow the steps below:</p>

      <ol type="1">
        <li>
          <p>Expose objects and call-back functions in your Angular controller:</p>

          <div>
            <pre><code>MyCtrl.$inject = ['$scope'];
function MyCtrl($scope) {
  var ctrl = this;

  var ctrl.mapOptions = {
    center: [4.8447237, 52.3881895],
    zoom: 10,
    baseMap: 'national-geographic'
  };

  ctrl.myFacets = {
    facets: {
      locations: {
        count: 4262,
        boxes: [{
          count: 625,
          s: 52.28889,
          w: 4.856865,
          n: 52.33222,
          e: 5.019565
        }, {
          count: 1301,
          s: 52.33256,
          w: 4.763993,
          n: 52.40219,
          e: 4.844532
        }, {
          count: 2336,
          s: 52.33251,
          w: 4.844792,
          n: 52.42354,
          e: 5.025896
        }]
      }
    }
  };

  ctrl.boundsChanged = function(bounds) {
    // place your geospatial search code here, and make that update $scope.myFacets
    //
    // The &lt;bounds&gt; parameter has an object structure like:
    //
    // {
    //    'south': 51.0,
    //    'west': 4.11,
    //    'north': 53.0,
    //    'east': 5.25
    // }
    //
  };

}</code></pre>
          </div>

          <p></p>
        </li>
        <li>
          <p>Add <code>ml-esri-search-map</code> element in your template:</p>

          <div>
            <pre><code>&lt;ml-esri-search-map options="ctrl.mapOptions" facets="ctrl.myFacets.facets" bounds-changed="ctrl.boundsChanged(bounds)"&gt;&lt;/ml-esri-search-map&gt;</code></pre>
          </div>

          <p></p>
        </li>
      </ol>

      <h2>
        <a id="ml-esri-detail-map" class="anchor" href="#ml-esri-detail-map" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ml-esri-detail-map
      </h2>

      <h4>Description:</h4>

      <p>The <code>ml-esri-detail-map</code> directive is used to display 1 or more points on a smaller version of an Esri map.  This is typically used to give geospatial context to an individual document/object.</p>

      <h4>Attributes:</h4>

      <ul>
        <li>
          <code>geometry</code>: The geometry details of item to display on the map.  This attribute can take an array with a single point or an array of arrays of points:
          <ul>
            <li><code>[52.00, 4.84]</code>: Example of a single point.</li>
            <li><code>[[52.00, 4.84], [52.54, 4.890]]</code>: Example of multiple points.</li>
          </ul>
        </li>
        <li>
          <code>base-map</code>: The Esri base map to use (<a href="https://developers.arcgis.com/javascript/jsapi/esri.basemaps-amd.html">Esri base map options</a>).
        </li>
        <li>
          <code>zoom</code>: The zoom level of the map.
        </li>
      </ul>

      <h4>Example:</h4>

      <p>To use the <code>ml-esri-search-map</code> directive, you must first follow the steps in the <a href="#quickstart">Quickstart</a> section to prepare your application.  Then follow the steps below:</p>

      <ol type="1">
        <li>
          <p>Expose objects in your Angular controller:</p>

          <div>
            <pre><code>MyCtrl.$inject = ['$scope'];
function MyCtrl($scope) {
  var ctrl = this;
  var ctrl.mapData = {
    'geometry': [52.3881895, 4.8447237],
    'baseMap': 'streets',
    'zoom': 4
}</code></pre>
          </div>

          <p></p>
        </li>
        <li>
          <p>Add <code>ml-esri-detail-map</code> element in your template:</p>

          <div>
            <pre><code>&lt;ml-esri-detail-map geometry="ctrl.mapData.geometry" base-map="ctrl.mapData.baseMap" zoom='ctrl.mapData.zoom'&gt;&lt;/ml-esri-detail-map&gt;</code></pre>
          </div>

          <p></p>
        </li>
      </ol>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/daveegrant/ml-esri-maps-ng">ml-esri-maps-ng</a> is maintained by <a href="https://github.com/daveegrant">daveegrant</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
